ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 20),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.position = "top"))
legend.position = ("top")
legend.position = ("top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 30),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
axis.text = element_text(size = 5),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 30),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(size = 4),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle = p_value)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle =  '(p-value = ', p-value, ')', '(R-squared = ', r-squared, ')')+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation()+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle =  '(p-value = ', p-value, ')''(R-squared = ', r-squared,')')+
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation(correlation)+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", subtitle =  '(p-value = ', p-value, ')''(R-squared = ', r-squared,')')+
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation(correlation)+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
library(ggpmisc)
library(ggpmisc)
install.packages("ggmisc")
library(ggpmisc)
library(ggpmisc)
# Packages used for data wrangling and analysis
library(readxl)
library(janitor)
library(tidyverse)
library(gtsummary)
library(ggstatsplot)
mat_data <-
read_excel("~/Personal Docs/SWISS TPH scholarship application/First assignment/Raw Data.xlsx") %>%
clean_names()
# recode education
mat_data <- mat_data %>%
mutate (education_fac =
as.factor(recode(education,
"1" = "College or higher",
"2" = "High school graduate",
"3" = "Less than high school")))
# recode diet
mat_data <- mat_data %>%
mutate (diet_fac =
as.factor(recode(diet, "1" = "High", "2" = "Middle", "3" = "Low")))
# recode ses
mat_data <- mat_data %>%
mutate (ses_fac =
as.factor(recode(ses, "1" = "Low", "2" = "Middle", "3" = "High")))
# recode sex
mat_data <- mat_data %>%
mutate (sex_fac =
as.factor(recode(sex, "m" = "Male", "f" = "Female")))
# Reclass age
mat_data <- mat_data %>%
mutate (age = as.numeric(age))
# Create dummy varaibles for linear reg models
mat_data <- mat_data %>%
mutate (education_dummy = ifelse(education_fac == 'College or higher', 1, 0))
mat_data <- mat_data %>%
mutate (ses_fac_dummy = ifelse(ses_fac == 'High', 1, 0))
mat_data <- mat_data %>%
mutate (ses_fac_dummy = ifelse(ses_fac == 'High', 1, 0))
# Univariate model
hemo_model_uni <- mat_data %>%
select(ebf,age, sex_fac, education_fac, ses_fac, hemo) %>%
tbl_uvregression(
method = lm,
y = hemo,
hide_n = TRUE,
label =  c(ebf ~ "Exclusive breastfeeding duration, months",
age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
add_global_p()
#  multivariate model
hemo_model_multi <- lm(hemo ~ ebf + age + sex_fac + education_fac + ses_fac,
data = mat_data)
hemo_modelmulti_tab <- tbl_regression(hemo_model_multi,
label =  c(ebf ~ "Exclusive breastfeeding duration, months",
age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))
# Merged the univariate models and multivariate model in a single table
tbl_merge(
tbls = list(hemo_model_uni, hemo_modelmulti_tab),
tab_spanner = c("**Unadjusted model**", "**Adjusted model**")) %>%
bold_labels() %>%
italicize_levels() %>%
modify_caption("**Predictors of hemoglobin levels**")
# Determine R2
correlation <- cor(mat_data$ebf, mat_data$ebf)
# Determine p-value
p_value <- round(cor.test(mat_data$ebf, mat_data$hemo)$p.value , 2)
mat_data <- na.omit(mat_data)
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation(correlation)+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation(correlation)+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
stat_correlation(correlation)+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels", size = 15)+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 12),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 9),
text = element_text(size = 15),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 10),
text = element_text(size = 10),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 10),
text = element_text(size = 10, face = "bold"),
legend.title = element_blank(),
legend.position = "top")
ggplot(data = mat_data, aes(x = ebf, y = hemo, colour = sex_fac)) +
geom_point()+
geom_smooth(method = "lm")+
ggtitle("Linear reltionship between exclusive breasfeeding duration and infant hemoglobin levels")+
xlab("Exclusive breastfeeding duration") + ylab("Hemoglobin levels (g/L)")+
theme_bw()+
theme(axis.text = element_text(size = 10),
text = element_text(size = 9, face = "bold"),
legend.title = element_blank(),
legend.position = "top")
library((flextable))
library(flextable)
# Merged the univariate models and multivariate model in a single table
tbl_merge(
tbls = list(hemo_model_uni, hemo_modelmulti_tab),
tab_spanner = c("**Unadjusted model**", "**Adjusted model**")) %>%
bold_labels() %>%
italicize_levels() %>%
modify_caption("**Predictors of hemoglobin levels**") %>%
as_flex_table()
# Merged the univariate models and multivariate model in a single table
tbl_merge(
tbls = list(hemo_model_uni, hemo_modelmulti_tab),
tab_spanner = c("**Unadjusted model**", "**Adjusted model**")) %>%
bold_labels() %>%
italicize_levels() %>%
modify_caption("**Predictors of hemoglobin levels**") %>%
as_flextable()
ggscatterstats(data  = mat_data,
x     = ebf,
y     = hemo,
xlab  = "Exclusive breastfeeding duration (months)",
ylab  = "Hemoglobin levels (g/L)",
bf.message = FALSE,
title = "Relationship between exclusive breastfeeding and hemoglobin levels"
)
tbl_summary(nut_char,
digits = list(ebf ~ 2, hemo ~ 2),
statistic = list(ebf ~ "{mean} ({sd})",
hemo ~ "{mean} ({sd})"),
type = list(diet_fac ~ "categorical",
hemo ~ "continuous",
ebf ~ "continuous"),
missing ="no",
label = c(ebf ~ "Exclusive breastfeeding duration, months",
diet_fac ~ "Dietary quality",
hemo ~ "Hemoglobin levels (g/L)")) %>%
italicize_levels() %>%
bold_labels() %>%
modify_caption("**Child nutritional and clinical characteristics**") %>%
as_flex_table()
tbl_summary(nut_char,
digits = list(ebf ~ 2, hemo ~ 2),
statistic = list(ebf ~ "{mean} ({sd})",
hemo ~ "{mean} ({sd})"),
type = list(diet_fac ~ "categorical",
hemo ~ "continuous",
ebf ~ "continuous"),
missing ="no",
label = c(ebf ~ "Exclusive breastfeeding duration, months",
diet_fac ~ "Dietary quality",
hemo ~ "Hemoglobin levels (g/L)")) %>%
modify_caption("**Child nutritional and clinical characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
%>%
tbl_summary(nut_char,
digits = list(ebf ~ 2, hemo ~ 2),
statistic = list(ebf ~ "{mean} ({sd})",
hemo ~ "{mean} ({sd})"),
type = list(diet_fac ~ "categorical",
hemo ~ "continuous",
ebf ~ "continuous"),
missing ="no",
label = c(ebf ~ "Exclusive breastfeeding duration, months",
diet_fac ~ "Dietary quality",
hemo ~ "Hemoglobin levels (g/L)")) %>%
modify_caption("**Child nutritional and clinical characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_flex_table()
demo_char <- mat_data %>%
select(age, sex_fac,	education_fac, ses_fac)
tbl_summary(demo_char,
digits = list(age ~ 2),
statistic = list(age ~ "{mean} ({sd})"),
type = list(age ~ "continuous"),
missing ="no",
label = c(age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
italicize_levels() %>%
bold_labels() %>%
modify_caption("**Maternal and child demographic Characteristics**")
nut_char <- mat_data %>%
select(ebf, diet_fac, hemo)
tbl_summary(nut_char,
digits = list(ebf ~ 2, hemo ~ 2),
statistic = list(ebf ~ "{mean} ({sd})",
hemo ~ "{mean} ({sd})"),
type = list(diet_fac ~ "categorical",
hemo ~ "continuous",
ebf ~ "continuous"),
missing ="no",
label = c(ebf ~ "Exclusive breastfeeding duration, months",
diet_fac ~ "Dietary quality",
hemo ~ "Hemoglobin levels (g/L)")) %>%
modify_caption("**Child nutritional and clinical characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_flex_table()
tbl_summary(demo_char,
digits = list(age ~ 2),
statistic = list(age ~ "{mean} ({sd})"),
type = list(age ~ "continuous"),
missing ="no",
label = c(age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
modify_caption("**Maternal and child demographic Characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_flex_table()
install.packages("latex")
library(latex)
tbl_summary(nut_char,
digits = list(ebf ~ 2, hemo ~ 2),
statistic = list(ebf ~ "{mean} ({sd})",
hemo ~ "{mean} ({sd})"),
type = list(diet_fac ~ "categorical",
hemo ~ "continuous",
ebf ~ "continuous"),
missing ="no",
label = c(ebf ~ "Exclusive breastfeeding duration, months",
diet_fac ~ "Dietary quality",
hemo ~ "Hemoglobin levels (g/L)")) %>%
modify_caption("**Child nutritional and clinical characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_gt()
tbl_summary(demo_char,
digits = list(age ~ 2),
statistic = list(age ~ "{mean} ({sd})"),
type = list(age ~ "continuous"),
missing ="no",
label = c(age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
modify_caption("**Maternal and child demographic Characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_gt()
# Merged the univariate models and multivariate model in a single table
tbl_merge(
tbls = list(hemo_model_uni, hemo_modelmulti_tab),
tab_spanner = c("**Unadjusted model**", "**Adjusted model**")) %>%
bold_labels() %>%
italicize_levels() %>%
modify_caption("**Predictors of hemoglobin levels**") %>%
as_gt()
r_squared
demo_char <- mat_data %>%
select(age, sex_fac,	education_fac, ses_fac)
tbl_summary(demo_char,
digits = list(age ~ 2),
statistic = list(age ~ "{mean} ({sd})"),
type = list(age ~ "continuous"),
missing ="no",
label = c(age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
modify_caption("**Maternal and child demographic Characteristics**") %>%
options(caption = "My Table Caption") %>%
italicize_levels() %>%
bold_labels() %>%
as_gt()
tbl_summary(demo_char,
digits = list(age ~ 2),
statistic = list(age ~ "{mean} ({sd})"),
type = list(age ~ "continuous"),
missing ="no",
label = c(age ~ "Infant age, months",
sex_fac ~ "Gender assigned at birth",
education_fac ~ "Mothers highest education",
ses_fac ~ "Household secio-economic status"))%>%
modify_caption("**Maternal and child demographic Characteristics**") %>%
italicize_levels() %>%
bold_labels() %>%
as_gt() %>%
gt::tab_header("Table 1. Maternal and child demographic Characteristics")
